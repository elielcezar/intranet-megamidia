{#
/**
 * @file
 * Theme override for main menu.
 *
 * Styled for sidebar navigation with icons.
 *
 * Available variables:
 * - menu_name: The machine name of the menu.
 * - items: A nested list of menu items.
 *
 * @see template_preprocess_menu()
 */
#}

{% import _self as menus %}

{#
  We call a macro which calls itself to render the full tree.
  @see https://twig.symfony.com/doc/1.x/tags/macro.html
#}
{{ menus.menu_links(items, attributes, 0) }}

{% macro menu_links(items, attributes, menu_level) %}
  {% import _self as menus %}
  
  {% if items %}
    {% if menu_level == 0 %}
      <ul{{ attributes.addClass('sidebar__nav-menu space-y-1') }}>
    {% else %}
      <ul class="sidebar__nav-submenu ml-6 mt-1 space-y-1">
    {% endif %}
    
    {% for item in items %}
      {% set item_classes = [
        'sidebar__nav-item',
        'w-full',
        'flex',
        'items-center',
        'gap-3',
        'px-4',
        'py-3',
        'text-sm',
        'font-medium',
        'rounded-lg',
        'transition-colors',
        'no-underline',
        item.in_active_trail ? 'bg-brand-50 text-brand-700' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900',
      ] %}
      
      <li{{ item.attributes }}>
        <a href="{{ item.url }}" class="{{ item_classes|join(' ') }}"{{ item.in_active_trail ? ' aria-current="page"' }}>
          
          {# Icon based on menu item title or machine name #}
          {% if 'in√≠cio' in item.title|lower or 'home' in item.title|lower %}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
          {% elseif 'documento' in item.title|lower %}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14 2 14 8 20 8"/>
            </svg>
          {% elseif 'agenda' in item.title|lower or 'evento' in item.title|lower or 'calendar' in item.title|lower %}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
              <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
              <line x1="16" x2="16" y1="2" y2="6"/>
              <line x1="8" x2="8" y1="2" y2="6"/>
              <line x1="3" x2="21" y1="10" y2="10"/>
            </svg>
          {% elseif 'comunicado' in item.title|lower %}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
              <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
              <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
            </svg>
          {% else %}
            {# Default icon for other menu items #}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" x2="12" y1="8" y2="16"/>
              <line x1="8" x2="16" y1="12" y2="12"/>
            </svg>
          {% endif %}
          
          <span>{{ item.title }}</span>
        </a>
        
        {% if item.below %}
          {{ menus.menu_links(item.below, attributes, menu_level + 1) }}
        {% endif %}
      </li>
    {% endfor %}
    
    </ul>
  {% endif %}
{% endmacro %}

