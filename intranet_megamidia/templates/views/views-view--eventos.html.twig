{#
/**
 * @file
 * Theme override for the Events/Calendar listing view.
 *
 * Based on CalendarView from App.tsx - grid of event cards.
 *
 * Available variables:
 * - rows: The view results.
 * - header: The optional header.
 * - exposed: The exposed form widgets.
 * - pager: The pager element.
 *
 * @see template_preprocess_views_view()
 */
#}

{# Mock data for static mockup #}
{% set mock_events = [
  {
    'id': 'e1',
    'title': 'Town Hall Global',
    'description': 'Reunião mensal com toda a empresa para alinhamento estratégico.',
    'date': '2023-11-05',
    'time': '10:00',
    'location': 'Auditório Principal & Zoom',
    'category': 'Diretoria',
  },
  {
    'id': 'e2',
    'title': 'Treinamento de Compliance',
    'description': 'Treinamento obrigatório para novos colaboradores.',
    'date': '2023-11-08',
    'time': '14:00',
    'location': 'Sala de Treinamento 2',
    'category': 'RH',
  },
  {
    'id': 'e3',
    'title': 'Workshop de Inovação',
    'description': 'Sessão de brainstorming para novos produtos.',
    'date': '2023-11-12',
    'time': '09:00',
    'location': 'Lab Criativo',
    'category': 'Operações',
  },
  {
    'id': 'e4',
    'title': 'Happy Hour Mensal',
    'description': 'Confraternização no terraço com toda a equipe.',
    'date': '2023-11-24',
    'time': '18:00',
    'location': 'Rooftop',
    'category': 'Social',
  },
] %}

{# Category indicator colors #}
{% set category_indicators = {
  'Social': 'bg-yellow-400',
  'RH': 'bg-brand-500',
  'Diretoria': 'bg-gray-400',
  'TI': 'bg-purple-500',
  'Operações': 'bg-green-500',
} %}

{# Portuguese weekday/month mapping #}
{% set weekday_pt = {
  'Monday': 'segunda-feira',
  'Tuesday': 'terça-feira',
  'Wednesday': 'quarta-feira',
  'Thursday': 'quinta-feira',
  'Friday': 'sexta-feira',
  'Saturday': 'sábado',
  'Sunday': 'domingo',
} %}
{% set month_pt = {
  'January': 'janeiro',
  'February': 'fevereiro',
  'March': 'março',
  'April': 'abril',
  'May': 'maio',
  'June': 'junho',
  'July': 'julho',
  'August': 'agosto',
  'September': 'setembro',
  'October': 'outubro',
  'November': 'novembro',
  'December': 'dezembro',
} %}

<div class="events-view space-y-6 animate-fade-in">
  
  {# Header #}
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
    <h2 class="text-2xl font-bold text-gray-900">{{ 'Agenda Corporativa'|t }}</h2>
    <div class="flex gap-2">
      <button type="button" class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm text-gray-600 hover:bg-gray-50">
        {{ 'Mês'|t }}
      </button>
      <button type="button" class="px-3 py-1.5 bg-brand-50 border border-brand-200 rounded-lg text-sm text-brand-700 font-medium">
        {{ 'Lista'|t }}
      </button>
    </div>
  </div>

  {# Exposed Filters (if any) #}
  {% if exposed %}
    <div class="card bg-white p-4 rounded-xl border border-gray-100">
      {{ exposed }}
    </div>
  {% endif %}

  {# Events Grid #}
  <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for event in mock_events %}
      {% set weekday = event.date|date('l') %}
      {% set day = event.date|date('d') %}
      {% set month = event.date|date('F') %}
      {% set indicator_class = category_indicators[event.category]|default('bg-gray-400') %}
      
      <div class="event-card card bg-white rounded-2xl shadow-sm border border-gray-100 p-6 flex flex-col relative overflow-hidden group hover:shadow-md transition-all">
        
        {# Category Indicator #}
        <div class="event-card__indicator absolute top-0 left-0 w-1 h-full {{ indicator_class }}"></div>
        
        {# Header #}
        <div class="event-card__header flex justify-between items-start mb-4 pl-4">
          <div>
            <span class="event-card__weekday text-sm font-bold text-gray-400 uppercase tracking-wider">
              {{ weekday_pt[weekday]|default(weekday) }}
            </span>
            <div class="event-card__date text-2xl font-bold text-gray-900">
              {{ day }} de {{ month_pt[month]|default(month) }}
            </div>
          </div>
          <div class="p-2 bg-gray-50 rounded-lg text-gray-400">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
              <line x1="16" x2="16" y1="2" y2="6"/>
              <line x1="8" x2="8" y1="2" y2="6"/>
              <line x1="3" x2="21" y1="10" y2="10"/>
            </svg>
          </div>
        </div>

        {# Content #}
        <div class="pl-4 flex-1">
          <h3 class="event-card__title text-lg font-bold text-gray-900 mb-2">{{ event.title }}</h3>
          <p class="event-card__description text-gray-500 text-sm mb-4">{{ event.description }}</p>
          
          {# Meta #}
          <div class="event-card__meta flex flex-col gap-2 text-sm text-gray-600 border-t border-gray-100 pt-4">
            <div class="flex items-center gap-2">
              <span class="event-card__meta-label w-20 text-gray-400 text-xs uppercase font-semibold">{{ 'Horário:'|t }}</span>
              <span>{{ event.time }}</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="event-card__meta-label w-20 text-gray-400 text-xs uppercase font-semibold">{{ 'Local:'|t }}</span>
              <span>{{ event.location }}</span>
            </div>
          </div>
        </div>
        
        {# Action Button #}
        <div class="pl-4 mt-6">
          <button type="button" class="w-full py-2 border border-brand-200 text-brand-600 rounded-lg text-sm font-medium hover:bg-brand-50 transition-colors">
            {{ 'Adicionar ao Calendário'|t }}
          </button>
        </div>
        
      </div>
    {% endfor %}
  </div>

  {# Drupal View Rows (if provided) #}
  {% if rows %}
    <div class="drupal-view-content mt-8">
      {{ rows }}
    </div>
  {% endif %}

  {# Pager #}
  {% if pager %}
    {{ pager }}
  {% endif %}
  
</div>

