{#
/**
 * @file
 * Theme override to display a Comunicado (Announcement) node.
 *
 * Layout estilo artigo de notícia: título em destaque, metadados, resumo e conteúdo.
 *
 * Available variables:
 * - node: The full node entity.
 * - label: The title of the node.
 * - content: All node items.
 *   - content.body: Conteúdo formatado do comunicado.
 *   - content.field_resumo: Resumo/descrição curta.
 *   - content.field_imagem_capa: Imagem de destaque.
 *   - content.field_categoria: Categoria (taxonomy term).
 * - formatted_date: Formatted creation date (d/m/Y).
 * - category_name: Name of the category taxonomy term.
 * - category_class: CSS class for category badge.
 * - url: URL of the node.
 * - view_mode: View mode (full, teaser, etc.).
 *
 * @see template_preprocess_node()
 * @see intranet_megamidia_preprocess_node()
 */
#}

{# Set default classes #}
{% set classes = [
  'node',
  'node--type-' ~ node.bundle|clean_class,
  node.isPromoted() ? 'node--promoted',
  node.isSticky() ? 'node--sticky',
  not node.isPublished() ? 'node--unpublished',
  view_mode ? 'node--view-mode-' ~ view_mode|clean_class,
] %}

{# Get category information #}
{% if node.field_categoria.entity %}
  {% set category_name = node.field_categoria.entity.name.value %}
  {% set category_class = category_class|default('bg-brand-100 text-brand-700') %}
{% endif %}

<article{{ attributes.addClass(classes) }}>
  
  {# Full View Mode #}
  {% if view_mode == 'full' %}
  
    <div class="max-w-4xl mx-auto space-y-8 animate-fade-in">
      
      {# Article Header #}
      <article class="space-y-6">
        
        {# Meta Info - Categoria e Data #}
        <div class="flex items-center gap-3 flex-wrap">
          {% if category_name %}
            <span class="badge px-3 py-1.5 text-xs font-semibold tracking-wide uppercase rounded-full {{ category_class }}">
              {{ category_name }}
            </span>
          {% endif %}
          {% if formatted_date %}
            <span class="text-sm text-gray-500">{{ formatted_date }}</span>
          {% endif %}
        </div>
        
        {# Title - Bem Grande #}
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 leading-tight tracking-tight">
          {{ label }}
        </h1>
        
        {# Resumo/Excerpt #}
        {% if content.field_resumo|render|trim %}
          <div class="text-xl text-gray-600 leading-relaxed border-l-4 border-brand-500 pl-6 py-2">
            {{ content.field_resumo }}
          </div>
        {% endif %}

        {# Imagem de Destaque (se houver) #}
        {#
        {% if content.field_imagem_capa|render|trim %}
          <div class="rounded-2xl overflow-hidden shadow-lg">
            {{ content.field_imagem_capa }}
          </div>
        {% endif %}
        #}
        
      </article>      
    
      {# Content Body #}
      <section class="prose prose-lg max-w-none text-gray-700 leading-relaxed">
        {{ content.body }}
      </section>
      
      {# Attachments (if any) #}
      {% if content.field_anexos|render|trim %}
        <section class="card bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
          <h3 class="text-lg font-bold text-gray-900 mb-4">{{ 'Anexos'|t }}</h3>
          {{ content.field_anexos }}
        </section>
      {% endif %}
      
     
      
    </div>
  
  {% else %}
  
    {# Teaser View Mode (for listings) #}
    <div class="card bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow flex flex-col">
      
      {# Image (if exists) #}
      {% if content.field_imagem_capa|render|trim %}
        <div class="relative h-40 bg-gray-100">
          {{ content.field_imagem_capa }}
        </div>
      {% endif %}
      
      {# Content #}
      <div class="p-6 flex-1 flex flex-col">
        
        {# Header with Category and Date #}
        <div class="flex justify-between items-start mb-4">
          {% if category_name %}
            <span class="badge px-2 py-1 text-xs font-medium rounded-md {{ category_class }}">
              {{ category_name }}
            </span>
          {% endif %}
          {% if formatted_date %}
            <span class="text-xs text-gray-400">{{ formatted_date }}</span>
          {% endif %}
        </div>
        
        {# Title #}
        <h4 class="font-bold text-gray-900 mb-2 line-clamp-2">
          {{ label }}
        </h4>
        
        {# Excerpt #}
        {% if content.field_resumo|render|trim %}
          <div class="text-sm text-gray-500 mb-4 line-clamp-3 flex-1">
            {{ content.field_resumo }}
          </div>
        {% endif %}
        
        {# Read More Link #}
        <a href="{{ url }}" class="text-sm font-medium text-brand-600 hover:underline inline-flex items-center gap-1">
          {{ 'Ler mais'|t }}
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m9 18 6-6-6-6"/>
          </svg>
        </a>
        
      </div>
    </div>
  
  {% endif %}
  
</article>

